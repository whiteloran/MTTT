# 战斗场景

*这一部分是武力战斗场景的相关规则。*

## 概述

在战斗场景，我们会分为三个部分来介绍具体的规则：小规模的战斗，大规模的战争与少对多的不对称战斗。
在一般的小规模战斗中，GM和PC们不需要考虑我们在前一节讲述的场景三大因素——因为通常的小规模战斗仅需将敌方歼灭即为胜利。但显然，在战斗场景中，我们是可以用上一节的场景共性来做出分别处理的。
现在，我们来具体看看每个不同的战斗场景。

## 小规模战斗

单挑、小队作战、团队对战等小规模武力冲突都适用于小规模战斗的规则。

### 战斗资源与战斗数值

在战斗中，我们需要先了解一下战斗内的单位拥有的战斗资源与一些关键数值。

#### 生命点数HP

显然，HP就是角色的生命值，当HP降到0以下后，角色即进入**无助**状态。HP主要由体质属性决定，对照如下：

| 体质属性等级 | 获得生命点 | 总生命点数 |
| ------------------ | ---------- | ---------- |
| 10                  | 0                 | 0|
| 11                  | 0                 | 0          |
| 12                  | 1                 | 1          |
| 13                  | 0                 | 1          |
| 14                  | 1                 | 2          |
| 15                  | 0                 | 2          |
| 16                  | 1                 | 3          |
| 17                  | 0                 | 3          |
| ……                  |                   | ……          |
| 20                  | 1                 | 5          |
| 30                 | 1                | 10         |


#### 变身护甲AR

魔法少女在变身后可以获得一定的护甲。任何低于护甲AR数值的伤害（Dam）将不会对魔法少女造成伤害；等于高于魔法少女的AR的伤害（Dam），会造成$Dam-AR+1$数值的伤害。

魔法少女的护甲主要由变身后的服装提供，其数值主要由HP提供。

>服装提供的AR
```tex
AR = [(1/3)*HP]
```

>注：在一般情况下，魔法少女在进入战斗的同时即可完成变身。

#### 伤害Dam

伤害是魔法少女的法术或是武装对目标的HP造成的损伤。在MTTT中，伤害主要分为两类：**（普通）伤害**和**致命伤害**。
对于**普通伤害**来说，直接按照其数值进行计算即可，但需要注意，有些时候**普通伤害**不能在目标身上全额起效。若是**致命伤害**，则会额外造成一定数额的普通伤害直到目标的**歪曲点数**达到最近的下一个5的倍数——也就是达到下一个**歪曲阶段**。


#### 歪曲阶段（CP，Chaos Phase）



#### 每回合法术力MP

所有角色的每回合法术力将在回合开始时同时恢复。MP决定了每个角色每回合能够使用的法术力。



#### 法术力上限MPM


### 战斗流程

#### 开始

#### 准备阶段

##### 阶段1：战斗准备

在战斗开始时，我们先进入**战斗准备**阶段。

其中的*第一步*，是确认所有参与战斗的**动态对象**的当前状态，包括属性、常驻效果和装备等。

然后我们开始进行*第二步*，确认所有参战单位的**法术力池**，包括各单位的法术力数量、法术力比值等。

*最后一步*，确定行动顺序——所有参与战斗的动态单位投掷**先攻**，根据先攻确定行动顺序——也即是轮执行者的顺序。

#### 主要阶段：战斗回合

##### 阶段1：解放法力

**第一回合：**根据**活化速度**（通常基于战场人数）展开所有参战单位的部分**法术力池**，直到达到目标的**法术力池上限** （通常需要2-5个回合），作为该回合该单位所能用的总法力量，记为**活化法力量**。
**第一回合后的每个回合：**解放法力阶段，继续展开**法术力池**（也就是重复第一回合的动作）。然后，将所有单位的可用法术力刷新到此时的**活化法力量**。

>例子：

##### 阶段2：行动轮

根据行动顺位，依次执行各单位的**轮（turn）**，各个单位的轮合起来，构成了一个**回合（round）**。理论上，各个**轮**是同时进行的，同一回合内的每一个**轮**都对应着同一个6秒的时间。一个**回合**的用时即为6秒。

一个行动轮包括：轮开始，轮响应，获得小节，主动步骤（消耗小节），轮结束。一共5个部分。

在每一个**轮**开始后，结算所有该**轮**的执行者单位上的**轮响应**。

该**轮**的执行者会获得两组*平行*的6个**小节（bar）**，包括6个**小节**和6个**移动小节**。

因为动态对象的机动作战，我们可以认为所有单位都是同时在进行移动和执行动作的。同理，在此过程中的插入阶段也会同时影响行动和移动，不可能单独影响行动或是移动（即，有些玩家的表述会把行动和移动分开，但这并不意味着在这个‘分开’处的时点执行插入阶段能够仅仅影响行动或是移动。）

通过消耗**小节**，轮执行者得以执行动作，包括普通攻击，施法，使用物品等，这些都会消耗不同数目的**小节**。而**移动小节**这种确定了前提的小节，则只能单纯用于执行移动动作（*一些特质可能让玩家得以利用移动小节进行指定的其它行动*）。在消耗小节后，一般直接结算小节行动的结果。

当该轮的执行玩家消耗完毕所有的**小节**或是主动选择结束当前**轮**（未消耗的**小节**将被视为已经消耗）时，进入当**轮**的结束阶段。准备开始下一个执行权玩家的**行动轮**。

**轮**开始前，**轮**开始后，结算**轮响应**，轮执行者获得小节前后，消耗小节，**轮**结束前后，下一**轮**开始前——都是可以进行插入阶段的时点。（未注明*前*，*时*，*后*的则为时点均可。）

#### 阶段3：结算法力

在所有单位的**行动轮**都结束后，结算各个单位的剩余法力，法术力池影响。

然后开始下一个战斗回合，直到战斗结束。



#### 中途加入：在战斗回合中，出现新的参战单位的处理

无准备的加入战斗者：

有准备的加入战斗者：

#### 插入阶段：瞬间法术与战时触发效果

这是一个可能存在的阶段。

因为瞬间法术使用**瞬间动作**，故只要法术力支持、施法条件支持，瞬间法术可以在**战斗回合阶段2：行动轮**中的任何**时点**使用。同理，因为战时触发效果不消耗**标准动作**，故只要法术力支持、触发条件发生，战时触发效果将在任何最先它被触发的时点*响应*触发效果。当一个瞬间法术被施展、或一个战时触发效果被触发，我们视为进入了*中断（interrupt）*，将会先行处理该瞬间法术或战时触发效果。

具体来说，在任何单位准备行动、正在行动或是将要结束当前行动的同时，可能施展瞬间法术的单位都可以选择施展*（like push）*瞬间法术。同理，任何单位的行动都可能触发其它单位的战时触发效果，其它单位（可以）选择响应触发，结算效果。在施展瞬间法术（响应战时触发效果）的同时，任何单位（包括当前瞬间法术施展者本身）都可以在该瞬间法术准备结算的基础上堆叠*（like push）*更多的瞬间法术与/或响应更多的战时触发效果。

若没有其它瞬间法术被施展或战时触发效果被响应，则直接结算*（like pop）*该瞬间法术或战时触发效果，然后退出*中断*，回到回合中继续执行当前行动（若仍可执行）与后续行动。若有其它瞬间法术被施展或战时触发效果被响应，则遵循*堆栈（stack）*的原则，最后施展的瞬间法术或被响应的战时触发效果最先结算，然后依次判断次后施展的瞬间法术或被响应的战时触发效果的合法性，若是合法则依次结算。注意，在结算过程中，任意次序的瞬间法术或被响应的战时触发效果准备结算时，都可以在此结算时点上，插入*（like push）*更多的瞬间法术（但不可能响应相同的战时触发效果，因为其触发在上一次结算时点已经触发）。然后，继续根据*堆栈*的原则，依次处理*（like pop）*所有的瞬间法术与/或被响应的战时触发效果直到处理完毕，退出*中断*，回到当前战斗回合。



*可选·禁用插入阶段*：虽然由于法术力池与灵魂玉数量的限制，插入阶段不可能堆栈过多。但如果认为插入阶段过于繁琐、影响游戏体验，GM可以直接禁用这一阶段。由于这个阶段本身就是外挂在战斗规则之上，故不会对平衡产生过多影响。



#### 结束阶段

##### 阶段1：战斗结算

在战斗结束后，统计各单位的状态，包括包括体力、属性、法术力池、常驻效果和装备等。

#### 结束



<div STYLE="page-break-after: always;"></div>

### 行动

#### 攻击：

通常而言，攻击动作需要消耗1个标准动作。



#### 施法：

大部分的标准法术（spell）都需要消耗6个小节。






#### 燃玉

仅在进行BOSS战斗时开放的规则。通过燃烧灵魂玉（点数）来暂时性增强战斗能力。

#### 燃玉点数的使用

燃玉点数能够以一个等差数列的形式，用点数增幅投掷骰子的结果。燃玉视为一个瞬发动作。例如，角色能以1+2+3点燃玉点数，增幅一个骰子的数值3点。
对于dX，此增幅的点数视为改变天然骰值。故，由燃玉将dx骰推向满骰时可以触发满骰效果。显然，在一个dx骰子上能投入的最大燃玉点数等于将其变为满骰的点数。若是一个骰子有+x，则可以任意投入拥有的燃玉点数进行增幅。若一个骰子并非dx+x，仅为dX，则角色不能进行+x的燃玉点数投入。在dx+x骰上，玩家可以随意在DX和+x上投入不同的燃玉点数。

#### 燃玉点数的获得

燃玉点数的获得分为两个阶段。第一阶段，在启动燃玉后，立刻转化角色剩余的所有灵魂玉为燃玉点数。
在第一阶段结束后，第二阶段开始。角色在本次战斗中，可以以瞬发动作将已经投入使用的灵魂玉(也即用于购买了属性或是物品或是法术等等的灵魂玉)按照自己的意愿转化为等值的燃玉点数。例如，玩家可以将一个购买时使用了500点灵魂玉的法术转化为500点燃玉点数，或是将一个18点的属性降到16，以获得30点燃玉点数。
在第二阶段中，燃烧已转化的灵魂玉带来的损失，包括法术失去或是属性降低等等，都将在本次战斗结束后再进行结算。

#### 燃玉点数的消失

未使用的燃玉点数将在本次战斗结束后消失。

### 范例